---
phase: 12-theme-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/styles/styles.scss
  - src/components/MarkdownRenderer.jsx
autonomous: true

must_haves:
  truths:
    - "Code blocks switch between dark and light highlight themes when theme toggles"
    - "All blog UI elements (cards, tags, navbar, lightbox) adapt to both dark and light themes"
    - "Theme transitions are smooth with no flash of wrong theme"
  artifacts:
    - path: "src/styles/styles.scss"
      provides: "Dark-theme-aware code block, lightbox, and navbar styles"
      contains: "data-theme.*dark.*code-block"
    - path: "src/components/MarkdownRenderer.jsx"
      provides: "Dynamic highlight.js theme loading based on current theme"
  key_links:
    - from: "src/components/MarkdownRenderer.jsx"
      to: "useTheme hook"
      via: "reads isDark to select highlight.js CSS"
      pattern: "useTheme|isDark"
    - from: "src/styles/styles.scss"
      to: "data-theme attribute"
      via: "CSS variable overrides in [data-theme=dark] block"
      pattern: "data-theme.*dark"
---

<objective>
Make all blog components fully theme-aware so dark/light toggle works consistently across portfolio and blog pages.

Purpose: Blog currently has hardcoded dark colors in code blocks, lightbox, and some navbar styles. These need to respond to the theme system like everything else.
Output: Updated SCSS with dark-mode overrides for blog elements, and MarkdownRenderer that dynamically switches highlight.js themes.
</objective>

<execution_context>
@/home/sanderburuma/.claude/get-shit-done/workflows/execute-plan.md
@/home/sanderburuma/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/12-theme-integration/12-CONTEXT.md
@src/styles/styles.scss
@src/components/MarkdownRenderer.jsx
@src/components/BlogNavbar.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Theme-aware code blocks with dual highlight.js themes</name>
  <files>src/components/MarkdownRenderer.jsx, src/styles/styles.scss</files>
  <action>
In MarkdownRenderer.jsx:
- Remove the static `import 'highlight.js/styles/atom-one-dark.css'` import
- Import `useTheme` from `../utils/hooks`
- Import both highlight.js theme CSS files: `highlight.js/styles/atom-one-dark.css` and `highlight.js/styles/atom-one-light.css`
- Actually, since both CSS files will be imported statically, the approach should be: import BOTH theme CSS files but scope them. The simpler approach: import both CSS files and use CSS specificity to control which one applies. Add a wrapper approach:
  - Keep importing `atom-one-dark.css` (it applies by default to `.hljs` classes)
  - In styles.scss, override the hljs colors for light theme. Specifically: in the default (light) `:root` scope, override `.hljs` background and key token colors to match atom-one-light. In `[data-theme="dark"]`, the atom-one-dark import remains as-is.
  - Alternative cleaner approach: Don't fight CSS imports. Instead, in MarkdownRenderer.jsx, dynamically add/remove a `<link>` element for the highlight theme, OR use the simpler CSS override approach in SCSS.

Best approach (CSS-only, no JS changes needed for theme swap):
1. Remove `import 'highlight.js/styles/atom-one-dark.css'` from MarkdownRenderer.jsx
2. In styles.scss, manually define the hljs theme colors for both themes using CSS variables and `[data-theme]` selectors. This avoids import conflicts.

In styles.scss, add after the existing code block styles:
- Default (light theme) `.hljs` styles matching atom-one-light: background `#fafafa`, text `#383a42`, comment `#a0a1a7`, keyword `#a626a4`, string `#50a14f`, number `#986801`, etc.
- `[data-theme="dark"] .hljs` styles matching atom-one-dark: background `#282c34`, text `#abb2bf`, comment `#5c6370`, keyword `#c678dd`, string `#98c379`, number `#d19a66`, etc.
- Add `transition: background-color 0.3s ease, color 0.3s ease` to `.hljs` for smooth theme transition animation on code blocks.
- Update `.code-block-wrapper` to use CSS variables instead of hardcoded `#282c34`. Use a new variable or reference `.hljs` background.
- Update `.code-line-numbers` color from hardcoded `#636d83` to use a CSS variable that shifts with theme.
- Update `.code-copy-btn` colors similarly.
- Update `.code-language-label` color similarly.
- Update `.code-line-numbers` border-right color from `#3e4451` to theme-aware.

Add these CSS custom properties to `:root` and `[data-theme="dark"]`:
```
:root {
  --code-bg: #fafafa;
  --code-text: #383a42;
  --code-comment: #a0a1a7;
  --code-line-numbers: #9d9d9f;
  --code-border: #e5e5e6;
  --code-btn-bg: rgba(0, 0, 0, 0.06);
  --code-btn-text: #696c77;
}
[data-theme="dark"] {
  --code-bg: #282c34;
  --code-text: #abb2bf;
  --code-comment: #5c6370;
  --code-line-numbers: #636d83;
  --code-border: #3e4451;
  --code-btn-bg: rgba(255, 255, 255, 0.1);
  --code-btn-text: #abb2bf;
}
```

Then update `.code-block-wrapper` background to `var(--code-bg)`, `.code-line-numbers` color to `var(--code-line-numbers)` and border-right to `var(--code-border)`, `.code-copy-btn` background to `var(--code-btn-bg)` and color to `var(--code-btn-text)`, `.code-language-label` color to `var(--code-line-numbers)`.

For the hljs token colors, define them inline in styles.scss (both light and dark):
```scss
// Light theme (default)
.hljs { background: var(--code-bg); color: var(--code-text); transition: background-color 0.3s ease, color 0.3s ease; }
.hljs-comment, .hljs-quote { color: #a0a1a7; font-style: italic; }
.hljs-keyword, .hljs-selector-tag { color: #a626a4; }
.hljs-string, .hljs-addition { color: #50a14f; }
.hljs-number, .hljs-literal { color: #986801; }
.hljs-built_in, .hljs-type { color: #c18401; }
.hljs-attr, .hljs-variable, .hljs-template-variable { color: #986801; }
.hljs-title, .hljs-section { color: #4078f2; }
.hljs-name, .hljs-selector-id, .hljs-selector-class { color: #e45649; }
.hljs-deletion { color: #e45649; }
.hljs-meta { color: #4078f2; }

[data-theme="dark"] {
  .hljs { background: var(--code-bg); color: var(--code-text); }
  .hljs-comment, .hljs-quote { color: #5c6370; font-style: italic; }
  .hljs-keyword, .hljs-selector-tag { color: #c678dd; }
  .hljs-string, .hljs-addition { color: #98c379; }
  .hljs-number, .hljs-literal { color: #d19a66; }
  .hljs-built_in, .hljs-type { color: #e6c07b; }
  .hljs-attr, .hljs-variable, .hljs-template-variable { color: #d19a66; }
  .hljs-title, .hljs-section { color: #61afef; }
  .hljs-name, .hljs-selector-id, .hljs-selector-class { color: #e06c75; }
  .hljs-deletion { color: #e06c75; }
  .hljs-meta { color: #61afef; }
}
```
  </action>
  <verify>Run `npm run build` to verify no build errors. Visually check that code blocks render with correct colors in both themes by running dev server.</verify>
  <done>Code blocks display atom-one-light colors in light theme, atom-one-dark colors in dark theme, with smooth transition animation between them. No hardcoded colors remain in code block styles.</done>
</task>

<task type="auto">
  <name>Task 2: Theme-aware lightbox, navbar backdrop, and remaining dark-mode fixes</name>
  <files>src/styles/styles.scss</files>
  <action>
In styles.scss, make these dark-theme additions:

1. **Blog navbar backdrop** (matches main navbar pattern): The main `.navbar` uses `rgba(255,255,255,.95)` background. The `.blog-navbar` uses `var(--bg-primary)` which is fine but lacks the translucent backdrop effect. Add:
```scss
[data-theme="dark"] .blog-navbar {
  background: rgba(15, 23, 42, 0.95);
  backdrop-filter: blur(10px);
}
```
And update the default `.blog-navbar` to also include `backdrop-filter: blur(10px)` and change background to `rgba(255, 255, 255, 0.95)` to match the main navbar style.

2. **Lightbox themed overlay**: Update `.image-lightbox` to use theme-aware backdrop:
```scss
.image-lightbox {
  // existing styles...
  background: rgba(0, 0, 0, 0.85);
}
[data-theme="dark"] .image-lightbox {
  background: rgba(0, 0, 0, 0.92);
}
```

3. **Dark theme for main navbar**: The `.navbar` has hardcoded `rgba(255,255,255,.95)`. Add dark override:
```scss
[data-theme="dark"] .navbar {
  background: rgba(15, 23, 42, 0.95);
}
```

4. **Ensure all blog-specific dark theme overrides are grouped together** in the existing `[data-theme="dark"]` section or a new blog-specific one, keeping the SCSS organized.

5. **Add transition to theme-dependent properties** where missing: Add `transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease` to `.blog-post-card`, `.tag-chip`, `.blog-navbar`, and `.image-lightbox` if not already covered by the existing `@include transition` mixin (check -- the mixin does `all 0.3s ease` so it likely covers this already; if so, no change needed).
  </action>
  <verify>Run `npm run build` to verify no errors. Check the blog navbar is translucent in both themes. Check lightbox overlay adapts.</verify>
  <done>Blog navbar has matching translucent backdrop in both themes. Lightbox overlay adapts to theme. Main navbar responds to dark theme. All blog elements transition smoothly between themes.</done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. Toggle theme on blog index page -- all cards, tags, navbar adapt
3. Toggle theme on blog post page -- code blocks switch between light/dark highlight themes with smooth transition
4. Navigate from portfolio to blog -- theme persists, no flash
5. Lightbox opens with themed overlay in both modes
</verification>

<success_criteria>
- Blog pages respect current dark/light theme setting (THEM-01)
- Theme toggle works on blog pages same as portfolio (THEM-02)
- Code blocks switch highlight theme (atom-one-light / atom-one-dark) based on current theme
- No hardcoded colors remain in blog-specific styles
- Theme transitions are smooth between portfolio and blog sections
</success_criteria>

<output>
After completion, create `.planning/phases/12-theme-integration/12-01-SUMMARY.md`
</output>
